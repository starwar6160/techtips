2018-08-06 09:15
git提交时不注意排除无用中间文件的危害：
1.极大增加版本库体积，典型版本库真正代码通常都是以KB为单位计算大小的，即便算上一些项目用到的图片等必备二进制文件，一般也不会多大，典型大小也就几M，而带有这些中间文件目录的话，经常能从几十K的大小变成几百M，几G大小；
2.极大增加PUSH和PULL操作的时间，从秒级变成分钟级，无谓的浪费时间和带宽。尤其是很多时候你没有宽带的时候，PULL这种版本库时间非常漫长，而这是可以完全避免的；
解决方法：
git初次提交之前检查去掉不该提交的大体积中间文件的方法，以service项目为例：
在该代码目录下输入 du -ksh * | grep -v K ，含义是列出所有下级目录大小，并以人类可读的K/M等格式标明目录大小，grep -v K，其中的-v含义是反转，也就是不包含K的结果，两者结合，列出来所有下级目录的大小，并只显示其中较大的以M甚至G为单位的的较大目录大小供我们查找较大的目录。一般来说达到M级别的目录，大部分都不需要，也最好不要提交到git，一般都是些中间文件目录。
找出来的第一个大目录是logs目录，321M大小，看名字，看看内容，显然是日志，排除。
第二个大目录是service目录，这是我们的主要代码目录，肯定要提交，所以这么大应该是下级目录里面有不需要的中间文件目录占用了太大体积，进去用同样的命令找出来接近300M的py36目录，这是virtualenv创建的Python 3.6虚拟环境目录，排除；还有两个bak结尾的目录较大，也排除。记住有了git，就不要复制各种bak目录了，老版本留在老的提交记录里面即可。所以两个bak目录也排除
打开https://github.com/github/gitignore，找到python的忽略文件，将其内容复制下来，然后在源码目录下git .gitignore,把内容粘贴进来,然后保存退出。为了便于使用，我把该仓库复制到了http://gogs:2180/zhouwei/gitignore.git
git add -n . 命令看看有哪些文件会被加入的。此时绝大部分Python的中间文件都被忽略了，但是还能看到有很多.whl文件，是Python软件包文件存在，也将其排除掉,方法是打开.gitignore文件，头部添加以下几行，也就是额外排除掉几个目录：
logs
service/py36
service/servicebak
service/staticfiles_Bak
*.whl
此时再git add -n . 命令看看会提交哪些文件，没有明显的多余中间文件的时候，就可以正式提交了。
其他各种语言各自有各自的中间文件和目录，例如nodejs的node_modules目录等等，绝大部分忽略文件规则都在https://github.com/github/gitignore里面可以找到，打开对应语言或者开发工具的忽略文件，将其内容复制到你的版本库下面的.gitignore文件中即可，但是也还是要手工比对一下有没有超出该文件范围的中间文件目录需要额外忽略的，检查完毕，添加完整了忽略文件以后，再进行第一次提交。
注意，windows下，你在资源管理器里面直接建立.gitignore文件是不行的，你可以用记事本粘贴了文件内容后，另存为这个名字到你的版本库根目录即可；
